<!DOCTYPE html>
<html>
<head>
	<!--vis.js-->
	<script src = "https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js" type="text/javascript"></script>
	<link href = "https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css"/>

	<!--bootstrap -->
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

	<!--jQuery-->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <style type="text/css">
        .border-1 {
            border: 1px solid lightgray;
        }
    </style>
</head>
<body>
<!--NavBar
<div class="container">
	<div class="row-fluid">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
		  <a class="navbar-brand" href="#">Navbar</a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
		    <span class="navbar-toggler-icon"></span>
		  </button>
		  <div class="collapse navbar-collapse" id="navbarNav">
		    <ul class="navbar-nav">
		      <li class="nav-item active">
		        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
		      </li>
		      <li class="nav-item">
		        <a class="nav-link" href="#">Features</a>
		      </li>
		      <li class="nav-item">
		        <a class="nav-link" href="#">Pricing</a>
		      </li>
		      <li class="nav-item">
		        <a class="nav-link disabled" href="#">Disabled</a>
		      </li>
		    </ul>
		  </div>
		</nav>
	</div>
</div>
-->

<div class="container my-5 border-1">
	<div class="row my-3">
		<div class="col">
			<div id="mynetwork" class="border-1"></div>
		</div>
	</div>
</div>

<div class="container my-5 py-2 border-1">
	<h1 class="text-center">Characters</h1>
	<form id="form-character">
	  <div class="form-group">
	  	<label>Name:</label>
	    <div class="input-group">
	      <input id="Add-Character-Name" type="text" class="form-control" placeholder="Name">
	    </div>
	  </div>
	  <div class="form-group">
	  	<label for="Group"> Group: </label>
	  	<input id="Add-Character-Group" type=text class="form-control" placeholder="Optional">
	  </div>
	  <div class="form-group">
	  	<button id="btnAddCharacter" type="submit" class="btn btn-default">Add Character</button>
	  </div>
	</form>
</div>

<div id="form-interaction" class="container my-5 py-2 border-1">
	<h1 class="text-center">Interactions</h1>
	<form>
	  <div class="form-group">
	  	<label>Characters: </label>
	    <div class="input-group">
	      <input id="Interaction-Char1" type="text" class="form-control" placeholder="Character 1">
	      <input id="Interaction-Char2" type="text" class="form-control" placeholder="Character 2">
	    </div>
	  </div>
	  <div class="form-group">
	  	<label for="Event Description">Interaction: </label>
	  	<input id="Interaction-Description" type=text class="form-control" placeholder="Event Description">
	  </div>
	  <div class="form-group">
	  	<button id="#btnAddConnection" type="submit" class="btn btn-default">Add Connection</button>
	  </div>
	</form>
</div>


<script type="text/javascript">
    // create an array with nodes
    var nodes = new vis.DataSet([
        /*{id: 1, label: 'Node 1'},
        {id: 2, label: 'Node 2'},
        {id: 3, label: 'Node 3'},
        {id: 4, label: 'Node 4'},
        {id: 5, label: 'Node 5'}*/
    ]);

    // create an array with edges
    var edges = new vis.DataSet([
        /*{from: 1, to: 3},
        {from: 1, to: 2},
        {from: 2, to: 4},
        {from: 2, to: 5}*/
    ]);

    // create a network
    var container = document.getElementById('mynetwork');

    // provide the data in the vis format
    var data = {
        nodes: nodes,
        edges: edges
    };
    var options = {
    	autoResize: true,
    	width: '100%',
    	height: '500px'
    };

    // initialize your network!
    var network = new vis.Network(container, data, options);
</script>

<script type="text/javascript">
	var characters = [];
	var groups = {}

	$("#form-character").submit(function(){
		var name=$("#Add-Character-Name").val();
		var group = $("#Add-Character-Group").val();
		//alert("form\nName="+name+"\nGroup="+group);
		if(name==""){
			return null;
		}
		if(!(characters.includes(name))){
			characters.push(name);
			nodes.add({id:characters.length-1,label:name});
		}
		if(group != ""){
			if(group in groups){
				if(!groups[group].includes(name)){
					for(var i = 0; i < groups[group].length; i++){
						edges.add({from:characters.indexOf(name),to:characters.indexOf(groups[group][i])});
					}
					groups[group].push(name);
				}
			} else{
				groups[group] = [name];
			}
		}
		var message = "Character=" + characters;
		message += "\nGroups=" + JSON.stringify(groups);
		console.log(message);
		//alert(message);
	});

	$("#form-interaction").submit(function(){
		var character1 = $("#Interaction-Char1").val();
		var character2 = $("#Interaction-Char2").val();

		var index1 = characters.indexOf(character1);
		var index2 = characters.indexOf(character2);

		console.log(index1);
		console.log(character1);
		console.log(index2);
		console.log(character2);

		if(index1 == -1 || index2 == -1){
			return null;
		} else{
			edges.add({from:index1, to:index2});
		}

	});



</script>

</body>
</html>